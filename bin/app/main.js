"use strict";var __=__||{},listners={};function bindEvent(t,a,n){window.listners[t+"|"+a]||(window.listners[t+"|"+a]={name:t,event:a},$(document).on(a,t,n))}function unbindEvent(t,a){delete window.listners[t+"|"+a],$(document).off(a,t)}L.CanvasOverlay=L.Class.extend({initialize:function(t,a){this._userDrawFunc=t,L.setOptions(this,a)},drawing:function(t){return this._userDrawFunc=t,this},params:function(t){return L.setOptions(this,t),this},canvas:function(){return this._canvas},redraw:function(){return this._frame||(this._frame=L.Util.requestAnimFrame(this._redraw,this)),this},onAdd:function(t){this._map=t,this._canvas=L.DomUtil.create("canvas","leaflet-heatmap-layer");var a=this._map.getSize();this._canvas.width=a.x,this._canvas.height=a.y;var n=this._map.options.zoomAnimation&&L.Browser.any3d;L.DomUtil.addClass(this._canvas,"leaflet-zoom-"+(n?"animated":"hide")),t._panes.overlayPane.appendChild(this._canvas),t.on("moveend",this._reset,this),t.on("resize",this._resize,this),t.options.zoomAnimation&&L.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._canvas),t.off("moveend",this._reset,this),t.off("resize",this._resize,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this),this_canvas=null},addTo:function(t){return t.addLayer(this),this},_resize:function(t){this._canvas.width=t.newSize.x,this._canvas.height=t.newSize.y},_reset:function(){var t=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(this._canvas,t),this._redraw()},_redraw:function(){var t=this._map.getSize(),a=this._map.getBounds(),n=180*t.x/(20037508.34*(a.getEast()-a.getWest())),i=this._map.getZoom();this._userDrawFunc&&this._userDrawFunc(this,{canvas:this._canvas,bounds:a,size:t,zoomScale:n,zoom:i,options:this.options}),this._frame=null},_animateZoom:function(t){var a=this._map.getZoomScale(t.zoom),n=this._map._getCenterOffset(t.center)._multiplyBy(-a).subtract(this._map._getMapPanePos());this._canvas.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(n)+" scale("+a+")"}}),L.canvasOverlay=function(t,a){return new L.CanvasOverlay(t,a)},$(function(){var n=L.map("map").setView([55.751244,37.618423],9);L.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}.png").addTo(n),$.get("bin/data/places.json",function(t){(function(a){L.canvasOverlay().drawing(function(i,t){var e=t.canvas.getContext("2d");e.clearRect(0,0,t.canvas.width,t.canvas.height),e.globalAlpha=.3,$.each(a,function(t,a){e.fillStyle="rgb(0, 98, 255)";var n=i._map.latLngToContainerPoint([a.point[1],a.point[0]]);e.beginPath(),e.arc(n.x,n.y,3,0,2*Math.PI),e.fill(),e.closePath(),a.canvas={x1:n.x,y1:n.y,x2:n.x+6,y2:n.y+6}})}).addTo(n)})(window.DATA=t),function(t){$.each(t,function(t,a){$("#places").append(__.placeItem(a))})}(t)}),$("#map").click(function(t){var n=t.offsetX,i=t.offsetY;$.each(DATA,function(t,a){n>a.canvas.x1&&n<a.canvas.x2&&i>a.canvas.y1&&i<a.canvas.y2&&console.log(i,a.canvas,a.name)})})}),__.placeItem=function(t){var a=t.eco.distance<10?"<div>".concat(t.eco.closest.name," в ").concat(t.eco.distance,"км</div>"):"",n=t.railroad.distance<3?'<div style="color: green">Ж/д станция '.concat(t.railroad.closest.name," в ").concat(t.railroad.distance,"км, до москвы: ").concat(t.railroad.closest.time.h,"ч ").concat(t.railroad.closest.time.m,"мин (").concat(t.railroad.closest.distance,"км)</div>"):"",i='<div class="place-item" id="place-'.concat(t.id,'"> <div>').concat(t.type," ").concat(t.name,'</div> <div style="color:red">').concat(t.price.from?t.price.from:""," ").concat(t.price.to?t.price.to:"","</div> <div>Расстояние до Москвы: ").concat(t.moscow.distance,"км</div> <div>На машине: ").concat(t.car.time.h,"ч ").concat(t.car.time.m,"мин (").concat(t.car.distance,"км)</div> ").concat(n," <div>Ближайший город: ").concat(t.city.closest.name," в ").concat(t.city.distance,"км</div> ").concat(a," <hr></div>");return bindEvent(".place-item","click",function(t){console.log(t)}),i};
//# sourceMappingURL=main.js.map
