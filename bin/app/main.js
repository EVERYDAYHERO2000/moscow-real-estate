var __={core:{},fs:{}}; "use strict";function _slicedToArray(t,n){return _arrayWithHoles(t)||_iterableToArrayLimit(t,n)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,n){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var a=[],e=!0,i=!1,o=void 0;try{for(var c,s=t[Symbol.iterator]();!(e=(c=s.next()).done)&&(a.push(c.value),!n||a.length!==n);e=!0);}catch(t){i=!0,o=t}finally{try{e||null==s.return||s.return()}finally{if(i)throw o}}return a}}function _arrayWithHoles(t){if(Array.isArray(t))return t}L.CanvasOverlay=L.Class.extend({initialize:function(t,n){this._userDrawFunc=t,L.setOptions(this,n)},drawing:function(t){return this._userDrawFunc=t,this},params:function(t){return L.setOptions(this,t),this},canvas:function(){return this._canvas},redraw:function(){return this._frame||(this._frame=L.Util.requestAnimFrame(this._redraw,this)),this},onAdd:function(t){this._map=t,this._canvas=L.DomUtil.create("canvas","leaflet-heatmap-layer");var n=this._map.getSize();this._canvas.width=n.x,this._canvas.height=n.y;var a=this._map.options.zoomAnimation&&L.Browser.any3d;L.DomUtil.addClass(this._canvas,"leaflet-zoom-"+(a?"animated":"hide")),t._panes.overlayPane.appendChild(this._canvas),t.on("moveend",this._reset,this),t.on("resize",this._resize,this),t.options.zoomAnimation&&L.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._canvas),t.off("moveend",this._reset,this),t.off("resize",this._resize,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this),this_canvas=null},addTo:function(t){return t.addLayer(this),this},_resize:function(t){this._canvas.width=t.newSize.x,this._canvas.height=t.newSize.y},_reset:function(){var t=this._map.containerPointToLayerPoint([0,0]);L.DomUtil.setPosition(this._canvas,t),this._redraw()},_redraw:function(){var t=this._map.getSize(),n=this._map.getBounds(),a=180*t.x/(20037508.34*(n.getEast()-n.getWest())),e=this._map.getZoom();this._userDrawFunc&&this._userDrawFunc(this,{canvas:this._canvas,bounds:n,size:t,zoomScale:a,zoom:e,options:this.options}),this._frame=null},_animateZoom:function(t){var n=this._map.getZoomScale(t.zoom),a=this._map._getCenterOffset(t.center)._multiplyBy(-n).subtract(this._map._getMapPanePos());this._canvas.style[L.DomUtil.TRANSFORM]=L.DomUtil.getTranslateString(a)+" scale("+n+")"}}),L.canvasOverlay=function(t,n){return new L.CanvasOverlay(t,n)},function(){var i={ru:{touch:"Коснитесь двумя для перемещения по карте",scroll:"Чтобы изменить масштаб, нажмите ctrl + прокрутка",scrollMac:"Чтобы изменить масштаб, нажмите ⌘ + прокрутка"}};L.Map.mergeOptions({gestureHandlingOptions:{text:{},duration:1e3}});var n=!1,t=L.Handler.extend({addHooks:function(){this._handleTouch=this._handleTouch.bind(this),this._setupPluginOptions(),this._setLanguageContent(),this._disableInteractions(),this._map._container.addEventListener("touchstart",this._handleTouch),this._map._container.addEventListener("touchmove",this._handleTouch),this._map._container.addEventListener("touchend",this._handleTouch),this._map._container.addEventListener("touchcancel",this._handleTouch),this._map._container.addEventListener("click",this._handleTouch),L.DomEvent.on(this._map._container,"mousewheel",this._handleScroll,this),L.DomEvent.on(this._map,"mouseover",this._handleMouseOver,this),L.DomEvent.on(this._map,"mouseout",this._handleMouseOut,this),L.DomEvent.on(this._map,"movestart",this._handleDragging,this),L.DomEvent.on(this._map,"move",this._handleDragging,this),L.DomEvent.on(this._map,"moveend",this._handleDragging,this)},removeHooks:function(){this._enableInteractions(),this._map._container.removeEventListener("touchstart",this._handleTouch),this._map._container.removeEventListener("touchmove",this._handleTouch),this._map._container.removeEventListener("touchend",this._handleTouch),this._map._container.removeEventListener("touchcancel",this._handleTouch),this._map._container.removeEventListener("click",this._handleTouch),L.DomEvent.off(this._map._container,"mousewheel",this._handleScroll,this),L.DomEvent.off(this._map,"mouseover",this._handleMouseOver,this),L.DomEvent.off(this._map,"mouseout",this._handleMouseOut,this),L.DomEvent.off(this._map,"movestart",this._handleDragging,this),L.DomEvent.off(this._map,"move",this._handleDragging,this),L.DomEvent.off(this._map,"moveend",this._handleDragging,this)},_handleDragging:function(t){"movestart"==t.type||"move"==t.type?n=!0:"moveend"==t.type&&(n=!1)},_disableInteractions:function(){this._map.dragging.disable(),this._map.scrollWheelZoom.disable(),this._map.tap&&this._map.tap.disable()},_enableInteractions:function(){this._map.dragging.enable(),this._map.scrollWheelZoom.enable(),this._map.tap&&this._map.tap.enable()},_setupPluginOptions:function(){this._map.options.gestureHandlingText&&(this._map.options.gestureHandlingOptions.text=this._map.options.gestureHandlingText)},_setLanguageContent:function(){var t;if(this._map.options.gestureHandlingOptions&&this._map.options.gestureHandlingOptions.text&&this._map.options.gestureHandlingOptions.text.touch&&this._map.options.gestureHandlingOptions.text.scroll&&this._map.options.gestureHandlingOptions.text.scrollMac)t=this._map.options.gestureHandlingOptions.text;else{var n=this._getUserLanguage();i[n=n||"ru"]&&(t=i[n]),t||-1===n.indexOf("-")||(n=n.split("-")[0],t=i[n]),t=t||i[n="ru"]}var a=!1;0<=navigator.platform.toUpperCase().indexOf("MAC")&&(a=!0);var e=t.scroll;a&&(e=t.scrollMac),this._map._container.setAttribute("data-gesture-handling-touch-content",t.touch),this._map._container.setAttribute("data-gesture-handling-scroll-content",e)},_getUserLanguage:function(){return navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage},_handleTouch:function(t){for(var n=["leaflet-control-minimap","leaflet-interactive","leaflet-popup-content","leaflet-popup-content-wrapper","leaflet-popup-close-button","leaflet-control-zoom-in","leaflet-control-zoom-out"],a=!1,e=0;e<n.length;e++)L.DomUtil.hasClass(t.target,n[e])&&(a=!0);a?L.DomUtil.hasClass(t.target,"leaflet-interactive")&&"touchmove"===t.type&&1===t.touches.length?(L.DomUtil.addClass(this._map._container,"leaflet-gesture-handling-touch-warning"),this._disableInteractions()):L.DomUtil.removeClass(this._map._container,"leaflet-gesture-handling-touch-warning"):"touchmove"===t.type||"touchstart"===t.type?1===t.touches.length?(L.DomUtil.addClass(this._map._container,"leaflet-gesture-handling-touch-warning"),this._disableInteractions()):(this._enableInteractions(),L.DomUtil.removeClass(this._map._container,"leaflet-gesture-handling-touch-warning")):L.DomUtil.removeClass(this._map._container,"leaflet-gesture-handling-touch-warning")},_isScrolling:!1,_handleScroll:function(t){t.metaKey||t.ctrlKey?(t.preventDefault(),L.DomUtil.removeClass(this._map._container,"leaflet-gesture-handling-scroll-warning"),this._map.scrollWheelZoom.enable()):(L.DomUtil.addClass(this._map._container,"leaflet-gesture-handling-scroll-warning"),this._map.scrollWheelZoom.disable(),clearTimeout(this._isScrolling),this._isScrolling=setTimeout(function(){for(var t=document.getElementsByClassName("leaflet-gesture-handling-scroll-warning"),n=0;n<t.length;n++)L.DomUtil.removeClass(t[n],"leaflet-gesture-handling-scroll-warning")},this._map.options.gestureHandlingOptions.duration))},_handleMouseOver:function(t){this._enableInteractions()},_handleMouseOut:function(t){n||this._disableInteractions()}});L.Map.addInitHook("addHandler","gestureHandling",t)}();var runApp=function(){__.core=__.fs.coreModuls(["$window","$app","$header","$map","$places","$placeSearch"]);var a=window.location.pathname;$.get("/bin/data/data.json",function(t){var n=__.fs.decodeData(t);__.core.$app.data("data",n),__.core.$map.trigger("createMap"),setTimeout(function(){__.core.$map.trigger("renderMap",{data:n})},300),a.includes("/place_")&&$.get("/bin/data".concat(a,"data.json"),function(t){__.detailScreen({place:t})})}),window.addEventListener("popstate",function(t){window.location.href=window.location.href},!1)};__.breadcrumbs=function(t){for(var n=t.links,a="",e=0;e<n.length;e++){var i='<meta itemprop="position" content="'.concat(e+1,'">'),o=n[e].name,c=n[e].url;a+=0==n[e].link?' <li itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem"> <span itemprop="name">'.concat(o,"</span> ").concat(i,' <meta itemprop="item" content="').concat(c,'"> </li> '):' <li class="breadcrumbs_item" itemprop="itemListElement" itemscope="" itemtype="http://schema.org/ListItem"> <span itemprop="name"> <a class="breadcrumbs_link" itemprop="item" href="'.concat(c,'">').concat(o,"</a> </span> ").concat(i," </li>")}return'<ol class="breadcrumbs" itemscope="" itemtype="http://schema.org/BreadcrumbList"> '.concat(a,"</ol> ")},__.detailScreen=function(c){var t,n,a,e,i,o,s,r,l,d,p,m,u,_,h,v,f,g,b,y,w,k,x,T,C,D,O,A,j,z,S,M,I,E,U,H,P,N,Z,R,F,V,W,B,Y,X,G,q,J,K,Q,tt,nt,at,et,it,ot,ct,st,rt,lt,dt,pt,mt,ut,_t,ht="",vt="",ft=c.place;ft?(t=ft.id,n=ft.name,ut=ft.id,_t=100*Math.floor(ut/100),a="https://myhousehub.ru/places/".concat(_t,"/place_").concat(ut,"/"),e=ft.description,i=ft.type?"".concat(ft.type):"",o="turbo"==(mt=c.mode)||"amp"==mt?"":'<div class="header-mobile"> <a href="/" id="close-screen" name="close-screen" role="button" class="btn btn_back">Назад</a> </div>',s="turbo"==c.mode||"amp"==c.mode?"":'<div class="close-icon" role="button" id="close-panel"></div>',rt=c.mode,lt=c.canonical,dt="",pt=ft.point,"amp"==rt&&(dt='<a href="'.concat(lt,'"> <amp-img alt="map" src="https://static-maps.yandex.ru/1.x/?ll=').concat(pt[0],",").concat(pt[1],"&size=450,450&z=13&l=map&pt=").concat(pt[0],",").concat(pt[1],'" layout="responsive" width="450" height="450" /> </a> ')),r=dt,_ads="amp"!=c.mode?'<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"><\/script>\x3c!-- ads-box_1 --\x3e<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-3027365012127484" data-ad-slot="5702464578" data-ad-format="auto" data-full-width-responsive="true"></ins><script> (adsbygoogle = window.adsbygoogle || []).push({});<\/script>':'<amp-ad width="100vw" height="320" type="adsense" data-ad-client="ca-pub-3027365012127484" data-ad-slot="5702464578" data-auto-format="rspv" data-full-width=""> <div overflow=""></div></amp-ad>',w=function(t){for(var n="",a=gt(c.mode,"/favicon-32.png","myhousehub",16,16,"favicon"),e=0;e<t.length;e++){var i=t[e],o=100*Math.floor(i.id/100);n+='<li class="simple-list__item flex-line">'.concat(a,'<a href="https://myhousehub.ru/places/').concat(o,"/place_").concat(i.id,'/">').concat(i.type," ").concat(i.name,"</a></li>")}return n?'<ul class="simple-list">'.concat(n,"</ul>"):""}(ft.places),bt("Класс",ft.class,function(t){return t}),at=ft.address.name,et=ft.moscow.distance,it=ft.moscow.angle,ot=at?"".concat(at,". "):"",ct='<b class="value">'.concat(et," км</b>"),st="",339<=it&&it<=360&&(st="Западное направление"),0<=it&&it<=23&&(st="Западное направление"),24<=it&&it<=68&&(st="Юго-западное направление"),69<=it&&it<=113&&(st="Южное направление"),114<=it&&it<=158&&(st="Юго-восточное направление"),159<=it&&it<=203&&(st="Восточное направление"),204<=it&&it<=225&&(st="Северо-восточное направление"),226<=it&&it<=293&&(st="Северное направление"),294<=it&&it<=338&&(st="Северо-западное направление"),l="<p>Адрес посёлка: ".concat(ot).concat(st,", ").concat(ct," от центра Москвы.</p>"),nt=ft.city,d="<p>".concat(nt.closest.name,' в <b class="value">').concat(nt.distance," км</b> от посёлка.</p>"),bt("Расстояние от Москвы",ft.moscow.distance,function(t){return'<b class="value">'.concat(t," км</b>")}),_routeurl=(tt=ft.point,"https://yandex.ru/maps/213/moscow/?ll=".concat(tt[0],"%2C").concat(tt[1],"&mode=routes&rtt=auto&rtext=55.753215%2C37.622504~").concat(tt[1],"%2C").concat(tt[0])),Q=ft.car,p=' <p>На автомобиле до центра Москвы:</p> <p><b class="value">'.concat(Q.distance,' км</b>, <span class="value">').concat(Q.time.h," ч ").concat(Q.time.m,' мин</span> без учета пробок</p> <div class="btn-group"><a class="btn btn_ghost" rel="noreferrer noopener nofollow" target="_blank" href="').concat(_routeurl,'">Проложить маршрут</a></div>'),J=ft.railroad,K="https://rasp.yandex.ru/search/?fromId=c213&fromName=Москва&toName=".concat(J.closest.name,"&when=сегодня"),m=" <p>Ближайшая ж/д станция пригородной электрички ".concat(J.closest.name," (").concat(J.closest.route,')</p> <p>От посёлка до станции <b class="value">').concat(J.distance,' км</b>, дорога до Москвы займёт <span class="value">').concat(J.closest.time.h," ч ").concat(J.closest.time.m,' мин</span></p> <div class="btn-group"><a class="btn btn_ghost" rel="noreferrer noopener nofollow" target="_blank" href="').concat(K,'" >Расписание электричек</a></div>'),q=ft.markets,u='<p>Крупный сетевой магазин в <b class="value">'.concat(q.distance," км</b>.</p>"),_=function(){for(var t="",n=ft.water.closests,a=0;a<n.length;a++)if(n[a].closest){var e=n[a].closest;0<e.min&&(e.min!=e.max?t+='<li class="item-with-icon"><div class="icon icon_water icon_inline" ></div><div><p><b class="value">от '.concat(e.min," м. до ").concat(e.max," м.</b><br>Средняя глубина водоносного горизонта ").concat(e.median," м. (скважины в ").concat(e.name,")</p></div></li>"):t+='<li class="item-with-icon"><div class="icon icon_water icon_inline" ></div><div><p><b class="value">'.concat(e.median," м.</b><br>Cредняя глубина водоносного горизонта (скважины в ").concat(e.name,")</p></div></li>"))}return t=t.length?'<hr><p>Глубина водоносного горизонта в районе посёлка:</p> <ul class="simple-list"> '.concat(t," </ul>"):""}(),h=function(t){for(var n,a="",e=0;e<t.length;e++){var i=t[e].closest.description?"".concat(t[e].closest.description):"";a+='<li class="item-with-icon"><div class="icon icon_eco icon_inline" data-ico="'.concat(t[e].closest.type,'"></div><div><p><b class="value">').concat(t[e].distance.toFixed(1)," км</b><br>").concat(t[e].closest.name,". ").concat(i,"</p></div></li>")}return n=(a=a.length?'<ul class="simple-list">'.concat(a,"</ul>"):"").length?"Ближайшие источники загрязнения и шума:":"Рядом с поселком отсутствуют источники загрязнения и шума.","<p>".concat(n,"</p>").concat(a)}(ft.eco.closests),W=ft.price,B=ft.developer,Y={from:W.from?"undefined"!=typeof global?global.component("str-to-cost",{value:W.from})[0]:__.strToCost({value:W.from})[0]:"",to:W.to?"undefined"!=typeof global?global.component("str-to-cost",{value:W.to})[0]:__.strToCost({value:W.to})[0]:"",closest:W.closest?"undefined"!=typeof global?global.component("str-to-cost",{value:W.closest})[0]:__.strToCost({value:W.closest})[0]:""},X=(W.from?"Цена от <nobr><b>".concat(Y.from," руб.</b></nobr> "):"Ориентировочная цена на дома от <nobr><b>".concat(Y.closest," руб.</b></nobr> "))+(W.to?"до <nobr><b>".concat(Y.to," руб.</b></nobr>"):""),G=B?"Застройщик ".concat(B,"."):"",v=X?"".concat(X," ").concat(G):"".concat(G),bt("Застройщик",ft.developer,function(t){return t}),bt("Сайт",ft.site,function(t){var n=URL?new URL(t).host:t.replace(/^(http|https):\/\//g,"");return'<div class="flex-line">'.concat(gt(c.mode,"https://favicon.yandex.net/favicon/".concat(n),n,16,16,"favicon")," ").concat(yt(t,n),"</div>")}),V=ft.medic,f='<p>Cтанция скорой помощи в <b class="value">'.concat(V.distance," км</b>.</p>"),T=ft.point,C=ft.site,D=T[1]+.00304,O=T[1]-.00304,A=T[0]-.009066,j=T[0]+.009066,S=wt("".concat(z="https://","cian.ru/map/"),{deal_type:"sale",engine_version:2,"object_type[0]":1,offer_type:"suburban",zoom:16,center:"".concat(T[1],",").concat(T[0])}),M=wt("".concat(z,"realty.yandex.ru/moskovskaya_oblast/kupit/dom/karta/"),{leftLongitude:A,topLatitude:D,rightLongitude:j,bottomLatitude:O}),I=wt("".concat(z,"move.ru/moskovskaya_oblast/prodazha_domov/poisk_na_karte/"),{map_center:"".concat(T[1],",").concat(T[0]),zoom:16}),E=wt("".concat(z,"sob.ru/map/prodazha-zagorodnaja-nedvizhimost"),{ll:"".concat(T[1],",").concat(T[0]),z:16})+"&realty_type[]=3&realty_type[]=4&realty_type[]=5&realty_type[]=6&realty_type[]=7&realty_type[]=8&realty_type[]=9&realty_type[]=10&realty_type[]=11&realty_type[]=12",U=wt("".concat(z,"www.avito.ru/moskva/doma_dachi_kottedzhi"),{map:btoa(JSON.stringify({searchArea:{latBottom:O,latTop:D,lonLeft:A,lonRight:j}}))}),H=gt(c.mode,"https://favicon.yandex.net/favicon/cian.ru","cian.ru",16,16,"favicon"),P=gt(c.mode,"https://favicon.yandex.net/favicon/realty.yandex.ru","realty.yandex.ru",16,16,"favicon"),N=gt(c.mode,"https://favicon.yandex.net/favicon/avito.ru","realty.yandex.ru",16,16,"favicon"),Z=gt(c.mode,"https://favicon.yandex.net/favicon/sob.ru","sob.ru",16,16,"favicon"),R=gt(c.mode,"https://favicon.yandex.net/favicon/move.ru","move.ru",16,16,"favicon"),F=C?'<div class="btn-group"><a target="_blank" rel="noreferrer noopener nofollow" href="'.concat(C,'" class="btn btn_ghost">Сайт посёлка</a></div>'):"",g=' <ul class="simple-list"> <li class="simple-list__item flex-line">'.concat(H," ").concat(yt(S,"Циан"),'</li> <li class="simple-list__item flex-line">').concat(P," ").concat(yt(M,"Яндекс.Недвижимость"),'</li> <li class="simple-list__item flex-line on-mobile_hide">').concat(N," ").concat(yt(U,"Авито"),'</li> <li class="simple-list__item flex-line">').concat(Z," ").concat(yt(E,"Sob"),'</li> <li class="simple-list__item flex-line">').concat(R," ").concat(yt(I,"move.ru"),"</li> </ul> ").concat(F),y=function(t){var n="",a=!1;if(-1<t.distance){for(var e=0;e<t.closests.length;e++){var i=t.closests[e];if(3!=i.type){var o=1==i.type?i.name+" лесничество":i.name;n+='<li class="item-with-icon"><div class="icon icon_forest icon_inline" ></div><div><p>'.concat(o,"</p></div></li>")}else a=!0}n=" <p>".concat(a?"Рядом с посёлком есть лес.":"В <b>".concat(t.distance," км</b> от посёлка начинается лес."),"</p> ").concat(n?'<ul class="simple-list">'.concat(n,"</ul>"):"")}return n}(ft.forest),k=function(t){var n="",a=!1,e=0;if(-1<t.distance){for(var i=0;i<t.closests.length;i++){var o=t.closests[i];if(o.distance<5&&e<5){var c=o.closest.name;n+='<li class="item-with-icon"><div class="icon icon_school icon_inline" ></div><div><p>'.concat(c," в ").concat(o.distance," км</p></div></li>"),a=!0,e++}}n=" <p>Ближайшая к посёлку школа в <b>".concat(t.distance," км</b>:</p> ").concat(n?'<ul class="simple-list">'.concat(n,"</ul>"):""," <hr>")}return a?n:""}(ft.school),x=[{url:"https://myhousehub.ru/",name:"Коттеджные посёлки Москвы",link:!0},{name:n,url:a,link:!1}],b="undefined"!=typeof global?global.component("breadcrumbs",{links:x}):__.breadcrumbs({links:x}),vt="".concat(s," ").concat(b,'<main itemscope itemtype="http://schema.org/Dataset"> <h1 itemprop="name"><span>').concat(i,"</span> <span>").concat(n,'</span></h1> <meta itemprop="license" content="https://creativecommons.org/publicdomain/zero/1.0/"> <p itemprop="description">').concat(e,'</p> <div class="page-navigation"> <div class="page-navigation__inner"> <a href="#s_offer">Купить</a> <a href="#s_transport">Транспорт</a> <a href="#s_infrastructure">Инфраструктура</a> <a href="#s_eco">Экология</a> <a href="#s_map">Карта</a> </div> </div> <div class="panel__content content"> <section id="s_offer" class="content__section"> <h2>Купить дом в посёлке</h2> <p>').concat(v," Предложения о продаже в <nobr>").concat(i," ").concat(n,"</nobr>:</p> ").concat(g," </section> ").concat(_ads,' <section id="s_transport" class="content__section"> <h2>Транспортная доступность <nobr>').concat(i," ").concat(n,"</nobr></h2> ").concat(l," <hr> ").concat(p," <hr> ").concat(m,' </section> <section id="s_infrastructure" class="content__section"> <h2>Инфраструктура</h2> <div> ').concat(d," <hr> ").concat(f," <hr> ").concat(k," ").concat(u,' </div> </section> <section id="s_eco" class="content__section"> <h2>Экология</h2> <div> ').concat(y," ").concat(h," ").concat(_," </div> </section> ").concat(w?' <section id="s_places" class="content__section"> <h2>Коттеджные посёлки рядом с <nobr>'.concat(i," ").concat(n,"</nobr>:</h2> <div> ").concat(w," </div> </section> "):"",' <section id="s_map"> <figure id="place-map" class="map">').concat(r,"</figure> </section> </div></main> "),ht='<div id="detail-screen" data-id="'.concat(t,'" class="panel panel_detail"> ').concat(o,' <div class="panel__container"> ').concat(vt," </div></div>")):ht=$("#detail-screen")[0].outerHTML;function gt(t,n,a,e,i,o){return t=t||"html",o=o?'class="'.concat(o,'"'):"","amp"!=t?'<img src="'.concat(n,'" alt="').concat(a,'" ').concat(o," />"):'<amp-img src="'.concat(n,'" alt="').concat(a,'" ').concat(o,' layout="responsive" width="').concat(e,'" height="').concat(i,'"></amp-img>')}function bt(t,n,a){return n?function(t,n){return'<div class="content__item"> <div class="content__item-title"><h3>'.concat(t,'</h3></div> <div class="content__item-value">').concat(n,"</div> </div>")}(t,a(n)):""}function yt(t,n,a,e){return e=e?'data-link="'.concat(e,'"'):"",a=a?'class="'.concat(a,'"'):"","<a ".concat(a," ").concat(e,' rel="noreferrer noopener nofollow" target="_blank" href="').concat(t,'">').concat(n,"</a>")}function wt(t,n){t=t+"?"||"";var i=encodeURIComponent;return t+Object.entries(n).map(function(t){var n=_slicedToArray(t,2),a=n[0],e=n[1];return"".concat(i(a),"=").concat(i(e))}).join("&")}if("undefined"==typeof global){$("#detail-screen").remove();var $t=__.core.$detailScreen?__.core.$detailScreen:$(ht);ft&&$t.find(".panel__container").empty().append(vt);var kt=100*Math.floor(ft.id/100);history.pushState(ft,ft.name,"/places/".concat(kt,"/place_").concat(ft.id,"/")),$("title").text(ft.title),setTimeout(function(){if($("#place-map").length){var n=function(){var t=new L.marker([ft.point[1],ft.point[0]],{icon:L.divIcon({className:"place-marker"})}),i=L.map("place-map",{center:[ft.point[1],ft.point[0]],zoom:14,gestureHandling:!0});L.tileLayer(__.fs.mapTiles.simple,{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(i),i.addLayer(t);L.canvasOverlay().drawing(function(t,n){var a=n.canvas.getContext("2d"),e=i.getZoom();a.clearRect(0,0,n.canvas.width,n.canvas.height),__.mapData().eco(function(){__.mapOverlay().eco({data:o},t,a,e,"place-map")}),__.mapData().railroad(function(){__.mapOverlay().railroad({data:o},t,a,e,"place-map")})}).addTo(i)};$("#place-map").empty();var o=$("#app").data("data");o?n():(ft=ft||null,$.get("/bin/data/data.json",function(t){o=__.fs.decodeData(t),id=$("#detail-screen").data("id"),$.each(o.places,function(t,n){if(n.id==id)return ft=n,!1}),ft&&n()}))}},100),$t.find("a").click(function(n){var t=$(this).attr("href");function a(t){$("#app").is(".mobile")&&(n.preventDefault(),location.href=t)}t.includes("cian.ru")&&(__.fs.analytics("cta_go-to-store",{store:"cian"}),a(t)),t.includes("realty.yandex.ru")&&(__.fs.analytics("cta_go-to-store",{store:"yandex"}),a(t)),t.includes("avito.ru")&&(__.fs.analytics("cta_go-to-store",{store:"avito"}),a(t)),t.includes("sob.ru")&&(__.fs.analytics("cta_go-to-store",{store:"sob.ru"}),a(t)),t.includes("move.ru")&&(__.fs.analytics("cta_go-to-store",{store:"move.ru"}),a(t))}),$t.find("#close-screen, #close-panel").click(function(t){t.preventDefault(),$("#main").find("#detail-screen").remove();var n="Коттеджные поселки подмосковья";history.pushState({},n,"/"),$("title").text(n),__.fs.analytics("close_detail-screen")}),$t.find('a[href^="#"]').click(function(t){t.preventDefault();var n="#"+$(this).attr("href").split("#")[1];$("#detail-screen").stop().animate({scrollTop:$(n).offset().top+$("#detail-screen").scrollTop()-65},500,"swing",function(){$("html, body").scrollTop(0)})}),__.core.$detailScreen=$t,$("#detail-screen").length||$("#main").append($t)}return ht},__.formFilter=function(t){if("undefined"==typeof global){e();var n=a();$(".filter-form").data("filter",n),$(".place-search__filter").click(function(t){$(".filter-form").closest(".panel__header").toggleClass("panel__header_absolute"),$(".filter-form").toggleClass("filter-form_hidden")}),$(".filter-form .form-tab__header").click(function(t){$(this).parent(".form-tab").toggleClass("form-tab_hidden")}),$(".select-direction svg").click(function(t){var n=[];$(".svg-select_active").each(function(){n.push($(this).attr("data-name"))}),$(this).parent().find("span").text(n.join(", "))}),$("#range-name_0").on("input change",function(t){var n=$(this).val(),a=__.strToCost({value:n})[0];$(this).parent().find("span").text("до ".concat(a," руб."))}),$("#range-name_1").on("input change",function(t){var n=$(this).val(),a=Math.floor(n/60),e=n%60,i=a?"".concat(a,"ч ").concat(e,"мин"):"".concat(e,"мин");$(this).parent().find("span").text("".concat("Время в пути до Москвы до"," ").concat(i))}),$(".filter-form .svg-select").click(function(t){$(this).toggleClass("svg-select_active")}),$("#btn-reset").click(function(t){e();var n=a();$(".filter-form").data("filter",n),__.search({text:""}),$(".place-search__filter").click()}),$("#btn-find").click(function(t){var n=a();$(".filter-form").data("filter",n),__.search(n),$(".place-search__filter").click()})}function a(){var e,t={kp:$("#ch-name_1").prop("checked"),snt:$("#ch-name_2").prop("checked")},n=$("#range-name_0").val(),a=$("#range-name_1").val(),i=$("#ch-name_3").prop("checked"),o=(e=[],$(".svg-select_active").each(function(t,n){var a=$(n).attr("id");"top"==a&&e.push([226,293]),"top-right"==a&&e.push([204,225]),"right"==a&&e.push([159,203]),"bottom-right"==a&&e.push([114,158]),"bottom"==a&&e.push([69,113]),"bottom-left"==a&&e.push([24,68]),"left"==a&&e.push([339,360],[0,23]),"top-left"==a&&e.push([294,338])}),e.length||e.push([226,293],[294,338],[204,225],[69,113],[114,158],[24,68],[339,360],[0,23],[159,203]),e),c=$("#ch-name_4").prop("checked"),s=$("#ch-name_5").prop("checked");return{text:$("#place-search-input").val(),types:t,distance:a,railroad:i,direction:o,cost:n,eco:c,forest:s}}function e(){$("#ch-name_1, #ch-name_2").prop("checked",!0),$("#ch-name_3, #ch-name_4, #ch-name_5").prop("checked",!1),$("#range-name_1").val(5e7),$("#range-name_1").val(300),$(".svg-select").removeClass("svg-select_active"),$("#place-search-input").val("").attr("data-value","")}return!1},__.logo=function(t){var n=t.title?t.title:'<span class="header__title">Найти коттеджный посёлок</span>';return'<div class="header__logo"> <a href="/"><img alt="myhousehub" class="header__icon" src="/source/assets/img/myhousehub.svg" /></a> <div> <a href="/" class="header__sitename">MYHOUSEHUB</a> '.concat(n," </div> </div>")},__.mapControls=function(){var t={default:{title:"Карта"},eco:{title:"Экология",selected:!0},railroad:{title:"Электрички"},car:{title:"Автомобильные дороги"},cost:{title:"Цены"},school:{title:"Образование"},markets:{title:"Магазины"},water:{title:"Скважины на воду"},forest:{title:"Лес"}},n="";for(var a in t){var e=t[a].selected?"layers-controls__item_selected":"";n+='<li><button class="layers-controls__item '.concat(e," ").concat(a,'" data-id="').concat(a,'">').concat(t[a].title,"</button></li>")}if(n="<ul>".concat(n,"</ul>"),"undefined"==typeof global){$(".layers-controls").html(i);var i=$(".layers-controls__item").click(function(t){var n=$(this).data("id");$(".layers-controls__item").removeClass("layers-controls__item_selected"),$(this).addClass("layers-controls__item_selected"),$("#map").data("canvas").redraw(),__.fs.analytics("change_map-mode",{mode:n})});$(".not-mobile .layers-controls ul").mouseenter(function(t){$(".layers-controls").addClass("layers-controls_visible")}).mouseleave(function(t){$(".layers-controls").removeClass("layers-controls_visible")})}return n},__.mapData=function(){$("#app").data("data");function n(e,n){$.get("/bin/data/".concat(e,".json"),function(t){"roads"!=e?$.each(t,function(t,n){if(window.DATA[e][n.id])for(var a in n)window.DATA[e][n.id][a]=n[a];else window.DATA[e][n.id]=n}):window.DATA[e]=t,$("#app").data("data",window.DATA),n()})}return this.eco=function(t){n("eco",t)},this.railroad=function(t){n("railroad",t)},this.markets=function(t){n("markets",t)},this.school=function(t){n("school",t)},this.car=function(t){n("roads",t)},this.water=function(t){n("water",t)},this.cost=function(t){n("cost",t)},this.forest=function(t){n("forest",t)},this.default=function(t){t()},this},__.mapObjectInfo=function(t,n,a){var e,i=$("#"+a),o="",c="",s="";"eco"==n&&(c=t.name,s=t.description?t.description:"",o='<div class="map-object-info"> <div class="map-object-info__inner"> <div class="icon icon_'.concat(n,'" data-ico="').concat(t.type,'"></div> <div class="map-object-info__content"> <span class="map-object-info__title">').concat(c,'</span> <p class="map-object-info__description">').concat(s,'</p> </div> <div> <div class="close-icon"></div></div>')),"markets"==n&&(o='<div class="map-object-info"> <div class="map-object-info__inner"> <div class="icon icon_'.concat(n,'" data-ico=""></div> <div class="map-object-info__content"> <span class="map-object-info__title">').concat(t.name,'</span> <p class="map-object-info__description">').concat(t.address,'</p> </div> </div> <div class="close-icon"></div></div>')),"school"==n&&(o='<div class="map-object-info"> <div class="map-object-info__inner"> <div class="icon icon_'.concat(n,'" data-ico=""></div> <div class="map-object-info__content"> <span class="map-object-info__title">').concat(t.name,'</span> </div> </div> <div class="close-icon"></div></div>')),"water"==n&&(o='<div class="map-object-info"> <div class="map-object-info__inner"> <div class="icon icon_'.concat(n,'" data-ico=""></div> <div class="map-object-info__content"> <span class="map-object-info__title">Скважина в "').concat(t.name,'"</span> <p class="map-object-info__description">Глубина скважины от ').concat(t.min," м. до ").concat(t.max,", средняя глубина ").concat(t.median,' м.</p> </div> </div> <div class="close-icon"></div></div>')),"railroad"==n&&(c="".concat(t.type?(e=t.type).charAt(0).toUpperCase()+e.slice(1):"Станция"," «").concat(t.name,"» (").concat(t.route,")"),s="До Москвы ".concat(t.distance,"км, ").concat(t.count," станция от Москвы. В пути ").concat(t.time.h,"ч ").concat(t.time.m,"мин."),o='<div class="map-object-info"> <div class="map-object-info__inner"> <div class="icon icon_'.concat(n,'" data-ico=""></div> <div class="map-object-info__content"> <span class="map-object-info__title">').concat(c,'</span> <p class="map-object-info__description">').concat(s,'</p> </div> </div> <div class="close-icon"></div></div>')),$("body").on("click",".map-object-info .close-icon",function(t){$(".map-object-info").remove()}),i.find(".map-object-info").remove(),i.append(o)},__.mapOverlay=function(t,n,a,e,i){var l=__.fs.mapSprites(2),o="/source/assets/img/map/pins@".concat(2,"x.png"),d=d=new Image;function p(t,n){return __.core.$map.data("icons")?n(__.core.$map.data("icons")):t.addEventListener("load",function(){__.core.$map.data("icons",t),n(t)}),t}function m(t,n,a,e,i,o,c){var s=a._map.latLngToContainerPoint([t.point[1],t.point[0]]),r={x1:s.x,x2:s.x+c,y1:s.y,y2:s.y+c};return o&&n.drawImage(e,0,o,i,i,s.x-c/2,s.y-c/2,c,c),r}return d.src=o,this.default=function(){return!1},this.markets=function(t,o,c,s,r){var n=t.data.markets;return p(d,function(i){$.each(n,function(t,n){var a="";9<s&&(a=l.point_green),11<s&&(a=l.markets);var e=m(n,c,o,i,40,a,26);n.canvas=n.canvas||{},n.canvas[r]=e})}),!1},this.school=function(t,o,c,s,r){var n=t.data.school;return p(d,function(i){$.each(n,function(t,n){var a="";9<s&&(a=l.point_blue),11<s&&(a=l.school);var e=m(n,c,o,i,40,a,26);n.canvas=n.canvas||{},n.canvas[r]=e})}),!1},this.water=function(t,o,c,s,r){var n=t.data.water;return p(d,function(i){$.each(n,function(t,n){var a="";9<s&&(a=l.point_blue),11<s&&(a=l.water_depth);var e=m(n,c,o,i,40,a,26);n.canvas=n.canvas||{},n.canvas[r]=e})}),!1},this.cost=function(t,n,a,e,i){return!1},this.forest=function(t,n,a,e,i){return!1},this.railroad=function(t,c,s,o,r){var n=t.data.railroad;return $.each(n,function(t,n){if(n.path){var a=n.path.points;s.beginPath(),s.strokeStyle="rgba(0, 196, 255, 0.5)",s.lineWidth=1,s.lineJoin="round",s.lineCap="round";for(var e=0;e<a.length;e++){var i=c._map.latLngToContainerPoint([a[e][1],a[e][0]]),o=a[e+1]?c._map.latLngToContainerPoint([a[e+1][1],a[e+1][0]]):i;s.moveTo(i.x,i.y),s.lineTo(o.x,o.y)}s.stroke()}}),p(d,function(i){$.each(n,function(t,n){var a="";9<o&&(a=l.point_blue),11<o&&(a=l.railroad);var e=m(n,s,c,i,40,a,26);n.canvas=n.canvas||{visible:!0},n.canvas[r]=e})}),!1},this.car=function(t,c,s,n,a){var e=t.data.roads;return $.each(e,function(t,n){var a=n.points;s.beginPath(),s.strokeStyle="rgba(0, 196, 255, 0.3)",s.lineWidth=1,s.lineJoin="round",s.lineCap="round";for(var e=0;e<a.length;e++){var i=c._map.latLngToContainerPoint([a[e][1],a[e][0]]),o=a[e+1]?c._map.latLngToContainerPoint([a[e+1][1],a[e+1][0]]):i;s.moveTo(i.x,i.y),s.lineTo(o.x,o.y)}s.stroke()}),!1},this.eco=function(t,o,c,s,r){var n=t.data.eco;p(d,function(i){$.each(n,function(t,n){var a=null;9<s&&(a=l.point_yellow),11<s&&(6==n.type&&(a=l.recicle),10==n.type&&(a=l.airport),7!=n.type&&9!=n.type||(a=l.trash),2!=n.type&&1!=n.type||(a=l.radiation),8!=n.type&&11!=n.type||(a=l.factory),5==n.type&&(a=l.water),4==n.type&&(a=l.energy),3==n.type&&(a=l.power),12==n.type&&(a=l.black_mesa),13==n.type&&(a=l.army));var e=m(n,c,o,i,40,a,26);n.canvas=n.canvas||{visible:!0},n.canvas[r]=e})})},this},__.mapTiles=function(t){var n=t.simple,a=t.dark,e=__.core.$map,i=e.data("tiles"),o="map_dark",c="map_light";function s(t,n){return e.removeClass(t).addClass(n),!1}function r(t){i._url!=t&&i.setUrl(t)}return this.default=function(){r(n),s(o,c)},this.markets=function(){r(a),s(c,o)},this.water=function(){r(a),s(c,o)},this.eco=function(){r(a),s(c,o)},this.railroad=function(){r(a),s(c,o)},this.car=function(){r(a),s(c,o)},this.cost=function(){r(a),s(c,o)},this.forest=function(){r(a),s(c,o)},this.school=function(){r(a),s(c,o)},this},__.miniMap=function(t){var n=[55.751244,37.618423],a=[t.lat,t.lon],e=[],i=1,o=1;return i=a[0]<n[0]?(e[0]=n[0]-a[0],1):(e[0]=a[0]-n[0],-1),o=a[1]<n[1]?(e[1]=a[1]-n[1],1):(e[1]=n[1]-a[1],-1),e[0]=80*e[0]/360*180*i,e[1]=80*e[1]/180*30*o,e[0]=e[0]<-40?-40:e[0],e[0]=40<e[0]?40:e[0],e[1]=e[1]<-40?-40:e[1],e[1]=40<e[1]?40:e[1],'<figure class="mini-map"> <div class="mini-map__marker" style="transform: translate('.concat(e[1],"px, ").concat(e[0],'px)"></div> </figure>')},__.placeItem=function(t){var n,a="undefined"!=typeof global?global.component("mini-map",{lat:t.point[1],lon:t.point[0]}):__.miniMap({lat:t.point[1],lon:t.point[0]}),e=t.type?"".concat(t.type):"",i="".concat(t.name),o=t.canvas&&t.canvas.color?(n=t.canvas.color.match(/\d+/g),"background-color:rgba(".concat(n[0],",").concat(n[1],",").concat(n[2],", .8)")):"",c='<div class="place-item__car">до Москвы: '.concat(t.car.time.h," ч ").concat(t.car.time.m," мин (").concat(t.car.distance," км)</div>"),s=t.railroad.closest&&t.railroad.distance<3?'<div class="place-item__train">ст. '.concat(t.railroad.closest.name," в ").concat(t.railroad.distance," км,<br>до Москвы: ").concat(t.railroad.closest.time.h," ч ").concat(t.railroad.closest.time.m," мин (").concat(t.railroad.closest.distance," км)</div>"):"",r=100*Math.floor(t.id/100),l="https://myhousehub.ru/places/".concat(r,"/place_").concat(t.id,"/"),d='<div itemscope="itemscope" itemtype="http://www.schema.org/SiteNavigationElement" class="place-item" data-id="place-'.concat(t.id,'"> <div class="place-item__content"> <div class="place-item__title"> <div class="place-item__pin" style="').concat(o,'"></div> <a href="').concat(l,'" itemprop="url"><span class="place-item__type">').concat(e,'</span><span class="place-item__name">').concat(i,'</span></a> <meta itemprop="name" content="').concat(e," ").concat(i,'"> </div> <div class="place-item__distance"> ').concat(c," ").concat(s," </div> </div> ").concat(a,"</div>");return"undefined"==typeof global&&__.fs.event.bind(".place-item","click",function(t){}),d},__.placePoint=function(t){var n=2*{0:{s:.5},1:{s:.5},2:{s:.5},3:{s:1},4:{s:1},5:{s:2},6:{s:2},7:{s:3},8:{s:3},9:{s:3},10:{s:4},11:{s:4},12:{s:4},13:{s:6},14:{s:6},15:{s:6},16:{s:12},17:{s:12},18:{s:12}}[t.zoom].s,a=$(".layers-controls__item_selected").data("id"),e=__.fs.colorize()[a](t.place);t.ctx.fillStyle=e,10<t.zoom&&(t.ctx.lineWidth=1,t.ctx.strokeStyle="rgba(255, 255, 255,.5)",t.ctx.stroke()),11<t.zoom&&(t.ctx.lineWidth=1,t.ctx.strokeStyle="rgb(255, 255, 255)",t.ctx.stroke());var i=t.canvasOverlay._map.latLngToContainerPoint([t.place.point[1],t.place.point[0]]);return t.ctx.beginPath(),t.ctx.arc(i.x,i.y,n/2,0,2*Math.PI),t.ctx.fill(),t.ctx.closePath(),t.place.canvas[t.mapId]={x1:i.x,y1:i.y,x2:i.x+n,y2:i.y+n},t.place.canvas.color=e,t.place.canvas},__.search=function(s){var t=$("#app").data("data").places,a=[],r=[],n=$("#map").data("map"),e=new __.fs.substringSearch({multiply:!1}),l={};return s.text||null!=s.types||null!=s.distance||null!=s.railroad||null!=s.direction||null!=s.eco||null!=s.cost||null!=s.forest?(s.text?a=e.inArray(s.text,t,function(t){return t.name},function(t){t.canvas.visible=!0},function(t){t.canvas.visible=!1}):$.each(t,function(t,n){n.canvas.visible=!0,a.push({res:{obj:n}})}),a.length?n.search=!0:n.search=!1,$.each(a,function(t,n){var a=n.res.obj;if(!l[a.id]){var e,i;if(null!=s.types)s.types.kp&&"КП"==a.type&&(e=!0),s.types.snt&&"КП"!=a.type&&(i=!0),e||i||(a.canvas.visible=!1);if(null!=s.railroad&&s.railroad&&3<a.railroad.distance&&(a.canvas.visible=!1),null!=s.cost&&s.cost<=5e7&&a.price.closest>=s.cost&&(a.canvas.visible=!1),null!=s.distance&&s.distance<300){var o=a.car.time.m<10?"0"+a.car.time.m:a.car.time.m;Number(a.car.time.h+""+o)>s.distance&&(a.canvas.visible=!1)}if(null!=s.direction&&s.direction.length){var c=!1;$.each(s.direction,function(t,n){a.moscow.angle>n[0]&&a.moscow.angle<n[1]&&(c=!0)}),c||(a.canvas.visible=!1)}null!=s.eco&&s.eco&&a.eco.distance<5&&-1!=a.eco.distance&&(a.canvas.visible=!1),null!=s.forest&&s.forest&&(1<a.forest.distance||a.forest.distance<0)&&(a.canvas.visible=!1),a.canvas.visible&&(l[a.id]=!0,r.push(a))}}),$("#places").trigger("renderList",{places:r,onlyVisible:!0}).scrollTop(0)):(n.search=!1,$.each(t,function(t,n){n.canvas.visible=!0}),$("#places").trigger("renderList",{places:t,onlyVisible:!1})),$("#map").data("canvas").redraw(),r},__.select=function(t){},__.selectOnMap=function(t,c,a){m();var n=$("#app").data("data"),e=n.places,s=t.offsetX,r=t.offsetY,l="";if(a&&"map"==c&&$.each(n[a],function(t,n){n.canvas&&s>n.canvas[c].x1-10&&s<n.canvas[c].x2-10&&r>n.canvas[c].y1-10&&r<n.canvas[c].y2-10&&(l+='<div data-type="'.concat(a,'" data-id="').concat(n.id,'" class="place-select__item place-select__item_object"><span class="icon icon_').concat(a,'" data-ico="').concat(n.type,'"></span><span>').concat(n.name,"</span></div>"))}),$.each(e,function(t,n){if(s>n.canvas[c].x1-10&&s<n.canvas[c].x2+10&&r>n.canvas[c].y1-10&&r<n.canvas[c].y2+10&&n.canvas.visible){var a=100*Math.floor(n.id/100),e="/places/".concat(a,"/place_").concat(n.id,"/"),i=n.type?n.type+" "+n.name:n.name,o=n.canvas.color.match(/\d+/g);l+=' <div data-id="'.concat(n.id,'" class="place-select__item place-select__item_place"> <div class="icon icon_place"><span style="background:rgba(').concat(o[0],",").concat(o[1],",").concat(o[2],',.8)"></span></div> <a data-id="').concat(n.id,'" href="').concat(e,'">').concat(i,"</a> </div>")}}),l){$("#map-controls").append('<div class="place-select">'.concat(l,"</div>"));var i=s-16,o=r-16,d=$("#map")[0].getBoundingClientRect(),p=$("#map-controls .place-select")[0].getBoundingClientRect();$("#map-controls .place-select").css({left:i+p.width>d.width?d.width-p.width+"px":i+"px",top:o+p.height>d.height?d.height-p.height+"px":o+"px"}),setTimeout(function(){$("#map-controls .place-select").addClass("place-select_visible")},10)}function m(){$("#map-controls").find(".place-select").remove()}__.fs.event.bind(".place-select","mouseleave",function(t){m()}),__.fs.event.bind(".place-select__item","click",function(t){if(t.preventDefault(),m(),$(this).is(".place-select__item_place")&&__.fs.placeGet($(this).data("id"),function(t,n){__.fs.analytics("select_place",{place_id:t.id,place_name:t.name,place_url:n,target:"map"}),__.detailScreen({place:t})}),$(this).is(".place-select__item_object")){var n=$(this).data("id"),a=$(this).data("type");__.fs.mapObjectGet(n,a,function(t){__.mapObjectInfo(t,a,c)})}})},__.strToCost=function(t){var n=t.value;return n=/\.\d/.test(n)?n+"":n+".00",(n=(n=/\.\d{2}/.test(n)?n:n+"0").replace(/\d(?=(\d{3})+\.)/g,"$& ")).split(".")},__.core.$app=function(){return $("#app").data("browser",__.fs.browserDetect()).addClass(function(){var t=$(this).data("browser");return[t.browserName,t.platform,t.isMobile].join(" ")}),$("#app")},__.core.$header=function(){return $("#change-view").click(function(){"На карте"!=$(this).text()?$(this).text("На карте"):$(this).text("Списком"),$("#main").toggleClass("main_screen-2"),__.fs.analytics("change_view",{change_to:$(this).text()})}),$("#header")},__.core.$map=function(){var e={},i=!1;return $("#map").on("mousedown touchstart",function(t){e={x:t.clientX||t.targetTouches[0].clientX,y:t.clientY||t.targetTouches[0].clientY}}).on("mouseup touchend",function(t){var n=t.clientX?t.clientX:t.changedTouches[0].clientX,a=t.clientY?t.clientY:t.changedTouches[0].clientY;n==e.x&&a==e.y&&(i=!0)}).on("click",function(t){var n=$(this).attr("id");$(t.target).is("canvas")&&i&&(__.selectOnMap(t,n,$(".layers-controls__item_selected").data("id")),i=!1)}),$("#map").bind("createMap",function(t){$(this).empty();var n=__.fs.mapTiles,a=$(t.target).attr("id"),e=L.map(a,{attributionControl:!1}).setView([55.751244,37.618423],9);L.control.attribution({position:"bottomleft"}).addTo(e);var i=L.tileLayer(n.dark,{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'});i.on("tileload",function(t){t.tile.setAttribute("alt","Map tile image"),t.tile.setAttribute("role","presentation")}).addTo(e),e.search=!1,$(t.target).data("map",e),$(t.target).data("tiles",i),$(t.target).data("tileset",n),__.mapControls(),e.on("dragstart zoomstart",function(t){$("#map-controls").find(".place-select").remove()}),$(".leaflet-bar").find("a").each(function(t,n){$(n).click(function(t){t.preventDefault(),$("#app").scrollTop(0)})})}).bind("renderMap",function(t,r){var e=this,l=r.data.places,n=$(t.target).data("map"),a=L.canvasOverlay().drawing(function(i,t){var o=t.canvas.getContext("2d"),c=$(e).data("map").getZoom(),s=$(e).attr("id");o.clearRect(0,0,t.canvas.width,t.canvas.height);var n=$(".layers-controls__item_selected").data("id"),a=$("#map").data("tileset");__.mapData()[n](function(){var e=$("#places").data("overlay")!=n;$.each(l,function(t,n){if(n.canvas.visible&&(n.canvas=__.placePoint({mapId:s,ctx:o,canvasOverlay:i,zoom:c,place:n})),e){var a=n.canvas.color.match(/\d+/g);$('#places .place-item[data-id="place-'.concat(n.id,'"] .place-item__pin')).css({backgroundColor:"rgba(".concat(a[0],",").concat(a[1],",").concat(a[2],",.8)")})}}),$("#places").data("overlay",n),window.DATA.places=l,$("#app").data("data",window.DATA),__.mapOverlay()[n](r,i,o,c,s),__.mapTiles(a)[n](),__.mapLegend()[n]()})}).addTo(n);$(e).data("canvas",a)}),$("#map")},__.core.placeScreen=function(){},__.core.$placeSearch=function(){return __.formFilter(),$("#place-search").bind("search",function(t,n){var a=$(this).find("input").val();__.search({text:a}),__.fs.analytics("search_place",{value:$(this).find("input").val()})}).keyup(function(t){13==t.which&&t.preventDefault(),$(this).find("input").attr("data-value",$(this).find("input").val())}).find(".place-search__search").click(function(t){t.preventDefault(),$(this).trigger("search")}),$("#place-search")},__.core.$places=function(){var s=!1,i=new L.marker([],{icon:L.divIcon({className:"place-marker"})}).on("click",function(t){a(t.target.options.id)});function a(t){__.fs.placeGet(t,function(t,n){__.fs.analytics("select_place",{place_id:t.id,place_name:t.name,place_url:n,target:"list"}),__.detailScreen({place:t})})}return $("#places").on("mouseenter",".place-item",function(t){var n=$("#app").data("data")?$("#app").data("data").places:[];if(n.length){var a=$(t.currentTarget).data("id").split("-")[1],e=$("#map").data("map");$.each(n,function(t,n){if(n.id==a)return i.setLatLng([n.point[1],n.point[0]]),i.options.id=n.id,e.hasLayer(i)||e.addLayer(i),!1})}}),$("#places").on("click",".place-item",function(t){t.preventDefault();$("#app").data("data").places,$("#map").data("map");var n=$(t.currentTarget).data("id").split("-")[1];$(".place-item").not(this).removeClass("place-item_active"),$(this).is(".place-item_active")?($(this).removeClass("place-item_active"),$("#detail-screen").remove()):($(this).addClass("place-item_active"),a(n))}),$("#places").scroll(function(t){var n=this,a=$(n).find(".place-item").last(),e=$(n).find(".place-item").length,i=$("#map").data("map");if(i&&!i.search&&a.length&&a.offset().top<2*$(window).outerHeight()){var o=function(t,a,e,i){$.each(t,function(t,n){if(i<t&&($(a).append(__.placeItem(n)),e--),!e)return!1})},c=$("#app").data("data").places;c[0].railroad.closest.name||s?o(c,n,100,e):($.get("/bin/data/railroad.json",function(t){$.each(t,function(t,n){if(window.DATA.railroad[n.id])for(var a in n)window.DATA.railroad[n.id][a]=n[a];else window.DATA.railroad[n.id]=n}),$("#app").data("data",window.DATA),o(c,n,100,e)}),s=!0)}}).bind("renderList",function(t,n){var a=this,e=n.onlyVisible||!1,i=n.places,o=$("#app").data("data").places;function c(){$("#places").empty(),setTimeout(function(){$.each(i,function(t,n){if(e)n.canvas.visible&&$(a).append(__.placeItem(n));else{if(!(t<100))return!1;$(a).append(__.placeItem(n))}})},1e3)}$(a).empty(),o[0].railroad.closest.name||s?c():(s=!0,$.get("/bin/data/railroad.json",function(t){$.each(t,function(t,n){if(window.DATA.railroad[n.id])for(var a in n)window.DATA.railroad[n.id][a]=n[a];else window.DATA.railroad[n.id]=n}),$("#app").data("data",window.DATA),c()}))}),$("#places")},__.core.$window=function(){var n=$("#header").outerHeight();window.innerHeight;function a(){$("#app").css({height:$(window).innerHeight()+"px"}),$("#main").css({height:"calc(100% - ".concat(n,"px)")});var t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(t,"px"))}return a(),$(window).resize(function(t){a()}),$(window)},__.fs.analytics=function(t,n){var a={event_url:location.href};return n&&$.each(n,function(t,n){a[t]=n}),window.amplitude&&amplitude.getInstance().logEvent(t,a),window.ym&&ym(55798045,"reachGoal",t,a),a},__.fs.baseUrl=function(){var t="",n=window.location.pathname;return"/"!=n&&"/index.html"!=n||(t=""),n.includes("/places/")&&(t="../../../"),t},__.fs.browserDetect=function(){var t,n,a,e=navigator,i=(e.appVersion,e.userAgent),o=e.appName,c=""+parseFloat(e.appVersion),s=parseInt(e.appVersion,10);-1!=(n=i.indexOf("Opera"))?(o="opera",c=i.substring(n+6),-1!=(n=i.indexOf("Version"))&&(c=i.substring(n+8))):-1!=(n=i.indexOf("MSIE"))?(o="ie",c=i.substring(n+5)):-1!=(n=i.indexOf("Chrome"))?(o="chrome",c=i.substring(n+7)):-1!=(n=i.indexOf("Safari"))?(o="safari",c=i.substring(n+7),-1!=(n=i.indexOf("Version"))&&(c=i.substring(n+8))):-1!=(n=i.indexOf("Firefox"))?(o="firefox",c=i.substring(n+8)):-1!=i.indexOf("FBAN")&&-1!=i.indexOf("FBAV")?(o="facebook",c=0):(t=i.lastIndexOf(" ")+1)<(n=i.lastIndexOf("/"))&&(o=i.substring(t,n),c=i.substring(n+1),o.toLowerCase()==o.toUpperCase()&&(o=e.appName)),-1!=(a=c.indexOf(";"))&&(c=c.substring(0,a)),-1!=(a=c.indexOf(" "))&&(c=c.substring(0,a)),s=parseInt(""+c,10),isNaN(s)&&(c=""+parseFloat(e.appVersion),s=parseInt(e.appVersion,10));var r,l,d=/iPad|iPhone|iPod/.test(e.userAgent)&&!window.MSStream,p=window.devicePixelRatio||1,m=window.screen.width*p,u=window.screen.height*p;return{browserName:o.toLowerCase(),fullVersion:c,majorVersion:s,appName:e.appName.toLowerCase(),userAgent:e.userAgent.toLowerCase(),platform:e.platform.toLowerCase(),iphoneX:d&&1125==m&&2436===u?"iphoneX":"",isMobile:(l="not-mobile",r=e.userAgent||e.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(r)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(r.substr(0,4)))&&(l="mobile"),l)}},__.fs.colorize=function(t){function o(t,n,a,e){return"rgba(".concat(t,",").concat(n,",").concat(a,",").concat(e,")")}function e(t,n,a,e,i){return e+(a-t)/(n-t)*((i-e)/1)}function i(t,n){var a=[];return a[3]=1-(1-n[3])*(1-t[3]),a[0]=Math.round(n[0]*n[3]/a[3]+t[0]*t[3]*(1-n[3])/a[3]),a[1]=Math.round(n[1]*n[3]/a[3]+t[1]*t[3]*(1-n[3])/a[3]),a[2]=Math.round(n[2]*n[3]/a[3]+t[2]*t[3]*(1-n[3])/a[3]),a}return this.default=function(){return o(0,98,255,.5)},this.markets=function(t){var n=t.markets.distance,a=i([226,30,220,.1],[0,98,255,n<3?1-e(0,3,n,0,1):0]);return o(a[0],a[1],a[2],a[3])},this.eco=function(t){var n=0<=t.eco.distance?t.eco.distance:100,a=i([0,98,255,.3],[255,30,0,n<=10?.6-e(0,10,n,0,.6):0]);return o(a[0],a[1],a[2],a[3])},this.water=function(t){var n=t.water.value,a=o(120,120,120,0);return 0<n&&(n<300&&(a=o(20,20,137,.2)),n<250&&(a=o(20,20,198,.2)),n<200&&(a=o(20,20,204,.2)),n<100&&(a=o(20,20,255,.3)),n<150&&(a=o(40,60,255,.3)),n<100&&(a=o(40,60,235,.4)),n<70&&(a=o(40,60,235,.5)),n<50&&(a=o(40,130,255,.7)),n<20&&(a=o(40,130,255,.7))),a},this.cost=function(t){var n=t.price.closest,a=o(225,0,0,.5);return 0<n&&(n<4e7&&(a=o(255,100,0,.5)),n<2e7&&(a=o(255,130,0,.5)),n<1e7&&(a=o(255,215,0,.5)),n<8e6&&(a=o(203,255,0,.3)),n<5e6&&(a=o(73,255,0,.3)),n<2e6&&(a=o(0,255,209,.3))),a},this.forest=function(t){var n=t.forest.distance,a=o(225,0,0,.3);return-1<n&&(n<1.5&&(a=o(250,230,30,.3)),n<1&&(a=o(170,250,30,.5)),n<.5&&(a=o(100,250,30,1))),a},this.school=function(t){var n=t.school.distance,a=o(225,0,0,.3);return-1<n&&(n<3&&(a=o(250,230,30,.3)),n<2&&(a=o(170,250,30,.5)),n<1&&(a=o(100,250,30,.5))),a},this.railroad=function(t){var n=t.railroad.distance,a=i([226,30,220,.1],[0,98,255,n<3?1-e(0,3,n,0,1):0]);return o(a[0],a[1],a[2],a[3])},this.car=function(t){var n,a=__.fs.time.toInt(t.car.time.h,t.car.time.m),e=t.roads.mcad.distance,i=t.roads.primary.distance;return a<=30&&(n=o(0,177,255,.3)),30<a&&(n=o(29,0,255,.3)),50<a&&(n=o(118,0,255,.3)),70<a&&(n=o(226,0,255,.3)),100<a&&(n=o(255,0,128,.2)),150<a&&(n=o(255,0,0,.2)),i<4&&(n=o(118,0,255,.3)),i<4&&a<120&&(n=o(29,0,255,.3)),e<6&&(n=o(0,118,255,.5)),i<2&&a<40&&(n=o(0,118,255,.5)),n},this},__.fs.coreModuls=function(t){var a={};return $.each(t,function(t,n){a[n]=__.core[n]()}),a},__.fs.decodeData=function(t){var n=t;return window.DATA={places:n,eco:{},railroad:{},markets:{},medic:{},cities:{},roads:{mcad:{},primary:{}},water:{},cost:{},forest:{},school:{}},$.each(t,function(t,n){n.canvas={visible:!0}}),window.DATA},__.fs.event={bind:function(t,n,a){var e=__.core.$app.data("listners")||{};e[t+"|"+n]||(e[t+"|"+n]={name:t,event:n},__.core.$app.data("listners",e),$(document).on(n,t,a))},unbind:function(t,n){var a=__.core.$app.data("listners")||{};delete a[t+"|"+n],__.core.$app.data("listners",a),$(document).off(n,t)}},__.fs.html=function(t){return t.replace(/\s+/g," ").trim()},__.mapLegend=function(){return $(".map-legend").length||$("#map .leaflet-bottom.leaflet-right").append('<div class="map-legend"></div>'),this.default=function(){return $(".map-legend").html(' <div class="item"> <div class="item__point" style="background:#0464ff;"></div> <div class="item__description">Посёлок</div> </div> '),!1},this.eco=function(){return $(".map-legend").html(' <div class="item"> <div class="item__point" style="background:rgba(0, 98, 255,1);"></div> <div class="item__description">Чисто</div> </div> <div class="item"> <div class="item__point" style="background:rgba(255, 30, 0,1);"></div> <div class="item__description">Рядом загрязнение или шум</div> </div> '),!1},this.cost=function(){return $(".map-legend").html(' <div class="item"> <div class="item__point" style="background:rgba(0, 255, 209, 1)"></div> <div class="item__description">< 2 млн. руб.</div> </div> <div class="item"> <div class="item__point" style="background:rgba(73, 255, 0, 1);"></div> <div class="item__description">< 5 млн. руб.</div> </div> <div class="item"> <div class="item__point" style="background:rgba(203, 255, 0, 1);"></div> <div class="item__description">< 8 млн. руб.</div> </div> <div class="item"> <div class="item__point" style="background:rgba(255, 215, 0, 1);"></div> <div class="item__description">< 10 млн. руб.</div> </div> <div class="item"> <div class="item__point" style="background:rgba(225, 0, 0, 1);"></div> <div class="item__description">Дорого</div> </div> '),!1},this.forest=function(){return $(".map-legend").html(' <div class="item"> <div class="item__point" style="background:rgba(100, 250, 30, 1);"></div> <div class="item__description">Лес рядом</div> </div> <div class="item"> <div class="item__point" style="background:rgba(250, 230, 30, 1);"></div> <div class="item__description">1.5 км до леса</div> </div> <div class="item"> <div class="item__point" style="background:rgba(225, 0, 0, 1);"></div> <div class="item__description">Лес далеко</div> </div> '),!1},this.railroad=function(){return $(".map-legend").html(' <div class="item"> <div class="item__point" style="background:rgba(0, 98, 255, 1);"></div> <div class="item__description">Рядом станция</div> </div> <div class="item"> <div class="item__point" style="background:rgba(226, 30, 220, 1);"></div> <div class="item__description">Станция далеко</div> </div> '),!1},this.car=function(){return $(".map-legend").html(' <div class="item"> <div class="item__point" style="background:rgba(0, 177, 255, 1);"></div> <div class="item__description">До Москвы 30 мин</div> </div> <div class="item"> <div class="item__point" style="background:rgba(226, 30, 100, 1);"></div> <div class="item__description">До Москвы больше часа</div> </div> '),!1},this.markets=function(){return $(".map-legend").html(' <div class="item"> <div class="item__point" style="background:rgba(0, 177, 255, 1);"></div> <div class="item__description">Рядом</div> </div> <div class="item"> <div class="item__point" style="background:rgba(226, 30, 100, 1);"></div> <div class="item__description">Далеко</div> </div> '),!1},this.school=function(){return $(".map-legend").html(' <div class="item"> <div class="item__point" style="background:rgba(100, 250, 30, 1);"></div> <div class="item__description">Школа рядом</div> </div> <div class="item"> <div class="item__point" style="background:rgba(226, 30, 100, 1);"></div> <div class="item__description">Далеко</div> </div> '),!1},this.water=function(){return $(".map-legend").html(' <div class="item"> <div class="item__point" style="background:rgba(40, 130, 255, 1);"></div> <div class="item__description">Глубина < 20 м</div> </div> <div class="item"> <div class="item__point" style="background:rgba(20, 20, 137, 1);"></div> <div class="item__description">Глубина > 200 м</div> </div> '),!1},this},__.fs.mapObjectGet=function(a,t,n){var e=$("#app").data("data")[t],i=null;$.each(e,function(t,n){n.id==a&&(i=(n.full,n))}),n(i)},__.fs.mapSprites=function(t){return{recicle:1,radiation:20*t,factory:40*t,trash:60*t,airport:80*t,energy:100*t,water:120*t,point_yellow:140*t,power:160*t,point_blue:180*t,point_green:200*t,railroad:220*t,black_mesa:240*t,army:260*t,markets:280*t,water_depth:300*t,school:340*t}},__.fs.mapTiles=function(){var t="chrome"==__.fs.browserDetect().browserName?"webp":"png";return{simple:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager_labels_under/{z}/{x}/{y}.".concat(t),dark:"https://{s}.tiles.mapbox.com/v4/mapbox.dark/{z}/{x}/{y}@2x.".concat(t,"?access_token=pk.eyJ1IjoiZ2xlYWZsZXQiLCJhIjoiY2lxdWxoODl0MDA0M2h4bTNlZ2I1Z3gycyJ9.vrEWCC2nwsGfAYKZ7c4HZA")}}(),__.fs.placeGet=function(t,n){var a=100*Math.floor(t/100),e="/bin/data/places/".concat(a,"/place_").concat(t,"/data.json");$.get(e,function(t){n(t,e)})},__.fs.substringSearch=function(m){(m=m||{}).weight=m.weight||100,m.multiply=m.multiply||!0;var u=this,_={weight:0,search:"",res:"",in:-1,out:-1,length:0};function h(t,n){for(var a=t.toLowerCase().trim(),e=(""+n.str).toLowerCase(),i=e.indexOf(a),o=m.weight,c=e.length,s=a.length,r=t.length*(o/10),l=[];;){var d=f(_);d.search=t,d.res=n;var p=e.indexOf(a,i);if(-1==p)break;s<=c&&e.indexOf(a,i)+1&&(d.weight+=50<c/s*100?o+r:c/s*o+r,d.weight=c-p,d.in=p,d.out=d.in+a.length,c===(d.length=s)&&(d.weight+=2*o),e[0]===a[0]&&(d.weight+=o)),l.push(d),i=p+1}return m.multiply||(l=[(l=l.sort(v))[0]]),l}function v(t,n){var a=0;return(t=t.weight)<(n=n.weight)?a=1:n<t&&(a=-1),a}function f(t){return Object.assign({},t)}return this.inString=function(t,n){var a=(t=""+t).length?t.trim().split(" "):[""],e=n.length?n.trim().split(" "):[""],i=a.length,o=t.length,c=e.length,s={str:n},r=[];if(o){if(t.indexOf(" ")+1){var l=h(t,s);l.weight&&(l.weight=l.weight*c),r=l}for(var d=i;d--;)r=r.concat(h(a[d],s));r=r.sort(v)}else{var p=f(_);p.search=t,p.res=s,r.push(p)}return r},this.inArray=function(t,n,a,e,i){t=""+t;for(var o=[],c=n.length;c--;){var s=a(n[c]),r={obj:n[c],str:s,index:c},l=u.inString(t,s),d=l.length;if(d){for(var p=d;p--;)e&&e(n[c]),l[p]&&(l[p].res=r);o=o.concat(l)}else i&&i(n[c])}return o=o.sort(v)},this},__.fs.time={toInt:function(t,n){return+((t=""+t)+(n=n<10?"0"+n:""+n))}},__.fs.url={objToUrl:function(t,n){t=t+"?"||"";var i=encodeURIComponent;return t+Object.entries(n).map(function(t){var n=_slicedToArray(t,2),a=n[0],e=n[1];return"".concat(i(a),"=").concat(i(e))}).join("&")}}; $(function(){runApp();console.log("0.2.0");})
//# sourceMappingURL=main.js.map
